(()=>{var t={838:function(t){t.exports=function(){"use strict";const{entries:t,setPrototypeOf:e,isFrozen:n,getPrototypeOf:r,getOwnPropertyDescriptor:o}=Object;let{freeze:i,seal:a,create:s}=Object,{apply:c,construct:u}="undefined"!=typeof Reflect&&Reflect;i||(i=function(t){return t}),a||(a=function(t){return t}),c||(c=function(t,e,n){return t.apply(e,n)}),u||(u=function(t,e){return new t(...e)});const l=E(Array.prototype.forEach),f=E(Array.prototype.pop),p=E(Array.prototype.push),h=E(String.prototype.toLowerCase),d=E(String.prototype.toString),m=E(String.prototype.match),y=E(String.prototype.replace),w=E(String.prototype.indexOf),v=E(String.prototype.trim),g=E(Object.prototype.hasOwnProperty),b=E(RegExp.prototype.test),S=(_=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(_,e)});var _;function E(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return c(t,e,r)}}function k(t,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;e&&e(t,null);let i=r.length;for(;i--;){let e=r[i];if("string"==typeof e){const t=o(e);t!==e&&(n(r)||(r[i]=t),e=t)}t[e]=!0}return t}function P(t){for(let e=0;e<t.length;e++)g(t,e)||(t[e]=null);return t}function O(e){const n=s(null);for(const[r,o]of t(e))g(e,r)&&(Array.isArray(o)?n[r]=P(o):o&&"object"==typeof o&&o.constructor===Object?n[r]=O(o):n[r]=o);return n}function T(t,e){for(;null!==t;){const n=o(t,e);if(n){if(n.get)return E(n.get);if("function"==typeof n.value)return E(n.value)}t=r(t)}return function(){return null}}const R=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),x=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=i(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),C=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),A=i(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),I=i(["#text"]),j=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),N=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),F=a(/<%[\w\W]*|[\w\W]*%>/gm),U=a(/\${[\w\W]*}/gm),G=a(/^data-[\-\w.\u00B7-\uFFFF]/),H=a(/^aria-[\-\w]+$/),Y=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),z=a(/^(?:\w+script|data):/i),Q=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),q=a(/^html$/i),X=a(/^[a-z][.\w]*(-[.\w]+)+$/i);var V=Object.freeze({__proto__:null,MUSTACHE_EXPR:W,ERB_EXPR:F,TMPLIT_EXPR:U,DATA_ATTR:G,ARIA_ATTR:H,IS_ALLOWED_URI:Y,IS_SCRIPT_OR_DATA:z,ATTR_WHITESPACE:Q,DOCTYPE_NAME:q,CUSTOM_ELEMENT:X});const $=1,K=3,Z=7,J=8,tt=9,et=function(){return"undefined"==typeof window?null:window};return function e(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et();const r=t=>e(t);if(r.version="3.1.6",r.removed=[],!n||!n.document||n.document.nodeType!==tt)return r.isSupported=!1,r;let{document:o}=n;const a=o,c=a.currentScript,{DocumentFragment:u,HTMLTemplateElement:_,Node:E,Element:P,NodeFilter:W,NamedNodeMap:F=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:U,DOMParser:G,trustedTypes:H}=n,z=P.prototype,Q=T(z,"cloneNode"),X=T(z,"remove"),nt=T(z,"nextSibling"),rt=T(z,"childNodes"),ot=T(z,"parentNode");if("function"==typeof _){const t=o.createElement("template");t.content&&t.content.ownerDocument&&(o=t.content.ownerDocument)}let it,at="";const{implementation:st,createNodeIterator:ct,createDocumentFragment:ut,getElementsByTagName:lt}=o,{importNode:ft}=a;let pt={};r.isSupported="function"==typeof t&&"function"==typeof ot&&st&&void 0!==st.createHTMLDocument;const{MUSTACHE_EXPR:ht,ERB_EXPR:dt,TMPLIT_EXPR:mt,DATA_ATTR:yt,ARIA_ATTR:wt,IS_SCRIPT_OR_DATA:vt,ATTR_WHITESPACE:gt,CUSTOM_ELEMENT:bt}=V;let{IS_ALLOWED_URI:St}=V,_t=null;const Et=k({},[...R,...x,...L,...C,...I]);let kt=null;const Pt=k({},[...j,...N,...B,...M]);let Ot=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Tt=null,Rt=null,xt=!0,Lt=!0,Dt=!1,Ct=!0,At=!1,It=!0,jt=!1,Nt=!1,Bt=!1,Mt=!1,Wt=!1,Ft=!1,Ut=!0,Gt=!1,Ht=!0,Yt=!1,zt={},Qt=null;const qt=k({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Xt=null;const Vt=k({},["audio","video","img","source","image","track"]);let $t=null;const Kt=k({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Zt="http://www.w3.org/1998/Math/MathML",Jt="http://www.w3.org/2000/svg",te="http://www.w3.org/1999/xhtml";let ee=te,ne=!1,re=null;const oe=k({},[Zt,Jt,te],d);let ie=null;const ae=["application/xhtml+xml","text/html"];let se=null,ce=null;const ue=o.createElement("form"),le=function(t){return t instanceof RegExp||t instanceof Function},fe=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ce||ce!==t){if(t&&"object"==typeof t||(t={}),t=O(t),ie=-1===ae.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,se="application/xhtml+xml"===ie?d:h,_t=g(t,"ALLOWED_TAGS")?k({},t.ALLOWED_TAGS,se):Et,kt=g(t,"ALLOWED_ATTR")?k({},t.ALLOWED_ATTR,se):Pt,re=g(t,"ALLOWED_NAMESPACES")?k({},t.ALLOWED_NAMESPACES,d):oe,$t=g(t,"ADD_URI_SAFE_ATTR")?k(O(Kt),t.ADD_URI_SAFE_ATTR,se):Kt,Xt=g(t,"ADD_DATA_URI_TAGS")?k(O(Vt),t.ADD_DATA_URI_TAGS,se):Vt,Qt=g(t,"FORBID_CONTENTS")?k({},t.FORBID_CONTENTS,se):qt,Tt=g(t,"FORBID_TAGS")?k({},t.FORBID_TAGS,se):{},Rt=g(t,"FORBID_ATTR")?k({},t.FORBID_ATTR,se):{},zt=!!g(t,"USE_PROFILES")&&t.USE_PROFILES,xt=!1!==t.ALLOW_ARIA_ATTR,Lt=!1!==t.ALLOW_DATA_ATTR,Dt=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ct=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,At=t.SAFE_FOR_TEMPLATES||!1,It=!1!==t.SAFE_FOR_XML,jt=t.WHOLE_DOCUMENT||!1,Mt=t.RETURN_DOM||!1,Wt=t.RETURN_DOM_FRAGMENT||!1,Ft=t.RETURN_TRUSTED_TYPE||!1,Bt=t.FORCE_BODY||!1,Ut=!1!==t.SANITIZE_DOM,Gt=t.SANITIZE_NAMED_PROPS||!1,Ht=!1!==t.KEEP_CONTENT,Yt=t.IN_PLACE||!1,St=t.ALLOWED_URI_REGEXP||Y,ee=t.NAMESPACE||te,Ot=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&le(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ot.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&le(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ot.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ot.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),At&&(Lt=!1),Wt&&(Mt=!0),zt&&(_t=k({},I),kt=[],!0===zt.html&&(k(_t,R),k(kt,j)),!0===zt.svg&&(k(_t,x),k(kt,N),k(kt,M)),!0===zt.svgFilters&&(k(_t,L),k(kt,N),k(kt,M)),!0===zt.mathMl&&(k(_t,C),k(kt,B),k(kt,M))),t.ADD_TAGS&&(_t===Et&&(_t=O(_t)),k(_t,t.ADD_TAGS,se)),t.ADD_ATTR&&(kt===Pt&&(kt=O(kt)),k(kt,t.ADD_ATTR,se)),t.ADD_URI_SAFE_ATTR&&k($t,t.ADD_URI_SAFE_ATTR,se),t.FORBID_CONTENTS&&(Qt===qt&&(Qt=O(Qt)),k(Qt,t.FORBID_CONTENTS,se)),Ht&&(_t["#text"]=!0),jt&&k(_t,["html","head","body"]),_t.table&&(k(_t,["tbody"]),delete Tt.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');it=t.TRUSTED_TYPES_POLICY,at=it.createHTML("")}else void 0===it&&(it=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";e&&e.hasAttribute(r)&&(n=e.getAttribute(r));const o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:t=>t,createScriptURL:t=>t})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(H,c)),null!==it&&"string"==typeof at&&(at=it.createHTML(""));i&&i(t),ce=t}},pe=k({},["mi","mo","mn","ms","mtext"]),he=k({},["foreignobject","annotation-xml"]),de=k({},["title","style","font","a","script"]),me=k({},[...x,...L,...D]),ye=k({},[...C,...A]),we=function(t){p(r.removed,{element:t});try{ot(t).removeChild(t)}catch(e){X(t)}},ve=function(t,e){try{p(r.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){p(r.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!kt[t])if(Mt||Wt)try{we(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},ge=function(t){let e=null,n=null;if(Bt)t="<remove></remove>"+t;else{const e=m(t,/^[\r\n\t ]+/);n=e&&e[0]}"application/xhtml+xml"===ie&&ee===te&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const r=it?it.createHTML(t):t;if(ee===te)try{e=(new G).parseFromString(r,ie)}catch(t){}if(!e||!e.documentElement){e=st.createDocument(ee,"template",null);try{e.documentElement.innerHTML=ne?at:r}catch(t){}}const i=e.body||e.documentElement;return t&&n&&i.insertBefore(o.createTextNode(n),i.childNodes[0]||null),ee===te?lt.call(e,jt?"html":"body")[0]:jt?e.documentElement:i},be=function(t){return ct.call(t.ownerDocument||t,t,W.SHOW_ELEMENT|W.SHOW_COMMENT|W.SHOW_TEXT|W.SHOW_PROCESSING_INSTRUCTION|W.SHOW_CDATA_SECTION,null)},Se=function(t){return t instanceof U&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof F)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},_e=function(t){return"function"==typeof E&&t instanceof E},Ee=function(t,e,n){pt[t]&&l(pt[t],(t=>{t.call(r,e,n,ce)}))},ke=function(t){let e=null;if(Ee("beforeSanitizeElements",t,null),Se(t))return we(t),!0;const n=se(t.nodeName);if(Ee("uponSanitizeElement",t,{tagName:n,allowedTags:_t}),t.hasChildNodes()&&!_e(t.firstElementChild)&&b(/<[/\w]/g,t.innerHTML)&&b(/<[/\w]/g,t.textContent))return we(t),!0;if(t.nodeType===Z)return we(t),!0;if(It&&t.nodeType===J&&b(/<[/\w]/g,t.data))return we(t),!0;if(!_t[n]||Tt[n]){if(!Tt[n]&&Oe(n)){if(Ot.tagNameCheck instanceof RegExp&&b(Ot.tagNameCheck,n))return!1;if(Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(n))return!1}if(Ht&&!Qt[n]){const e=ot(t)||t.parentNode,n=rt(t)||t.childNodes;if(n&&e)for(let r=n.length-1;r>=0;--r){const o=Q(n[r],!0);o.__removalCount=(t.__removalCount||0)+1,e.insertBefore(o,nt(t))}}return we(t),!0}return t instanceof P&&!function(t){let e=ot(t);e&&e.tagName||(e={namespaceURI:ee,tagName:"template"});const n=h(t.tagName),r=h(e.tagName);return!!re[t.namespaceURI]&&(t.namespaceURI===Jt?e.namespaceURI===te?"svg"===n:e.namespaceURI===Zt?"svg"===n&&("annotation-xml"===r||pe[r]):Boolean(me[n]):t.namespaceURI===Zt?e.namespaceURI===te?"math"===n:e.namespaceURI===Jt?"math"===n&&he[r]:Boolean(ye[n]):t.namespaceURI===te?!(e.namespaceURI===Jt&&!he[r])&&!(e.namespaceURI===Zt&&!pe[r])&&!ye[n]&&(de[n]||!me[n]):!("application/xhtml+xml"!==ie||!re[t.namespaceURI]))}(t)?(we(t),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!b(/<\/no(script|embed|frames)/i,t.innerHTML)?(At&&t.nodeType===K&&(e=t.textContent,l([ht,dt,mt],(t=>{e=y(e,t," ")})),t.textContent!==e&&(p(r.removed,{element:t.cloneNode()}),t.textContent=e)),Ee("afterSanitizeElements",t,null),!1):(we(t),!0)},Pe=function(t,e,n){if(Ut&&("id"===e||"name"===e)&&(n in o||n in ue))return!1;if(Lt&&!Rt[e]&&b(yt,e));else if(xt&&b(wt,e));else if(!kt[e]||Rt[e]){if(!(Oe(t)&&(Ot.tagNameCheck instanceof RegExp&&b(Ot.tagNameCheck,t)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(t))&&(Ot.attributeNameCheck instanceof RegExp&&b(Ot.attributeNameCheck,e)||Ot.attributeNameCheck instanceof Function&&Ot.attributeNameCheck(e))||"is"===e&&Ot.allowCustomizedBuiltInElements&&(Ot.tagNameCheck instanceof RegExp&&b(Ot.tagNameCheck,n)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(n))))return!1}else if($t[e]);else if(b(St,y(n,gt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==w(n,"data:")||!Xt[t])if(Dt&&!b(vt,y(n,gt,"")));else if(n)return!1;return!0},Oe=function(t){return"annotation-xml"!==t&&m(t,bt)},Te=function(t){Ee("beforeSanitizeAttributes",t,null);const{attributes:e}=t;if(!e)return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:kt};let o=e.length;for(;o--;){const i=e[o],{name:a,namespaceURI:s,value:c}=i,u=se(a);let p="value"===a?c:v(c);if(n.attrName=u,n.attrValue=p,n.keepAttr=!0,n.forceKeepAttr=void 0,Ee("uponSanitizeAttribute",t,n),p=n.attrValue,It&&b(/((--!?|])>)|<\/(style|title)/i,p)){ve(a,t);continue}if(n.forceKeepAttr)continue;if(ve(a,t),!n.keepAttr)continue;if(!Ct&&b(/\/>/i,p)){ve(a,t);continue}At&&l([ht,dt,mt],(t=>{p=y(p,t," ")}));const h=se(t.nodeName);if(Pe(h,u,p)){if(!Gt||"id"!==u&&"name"!==u||(ve(a,t),p="user-content-"+p),it&&"object"==typeof H&&"function"==typeof H.getAttributeType)if(s);else switch(H.getAttributeType(h,u)){case"TrustedHTML":p=it.createHTML(p);break;case"TrustedScriptURL":p=it.createScriptURL(p)}try{s?t.setAttributeNS(s,a,p):t.setAttribute(a,p),Se(t)?we(t):f(r.removed)}catch(t){}}}Ee("afterSanitizeAttributes",t,null)},Re=function t(e){let n=null;const r=be(e);for(Ee("beforeSanitizeShadowDOM",e,null);n=r.nextNode();)Ee("uponSanitizeShadowNode",n,null),ke(n)||(n.content instanceof u&&t(n.content),Te(n));Ee("afterSanitizeShadowDOM",e,null)};return r.sanitize=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,o=null,i=null,s=null;if(ne=!t,ne&&(t="\x3c!--\x3e"),"string"!=typeof t&&!_e(t)){if("function"!=typeof t.toString)throw S("toString is not a function");if("string"!=typeof(t=t.toString()))throw S("dirty is not a string, aborting")}if(!r.isSupported)return t;if(Nt||fe(e),r.removed=[],"string"==typeof t&&(Yt=!1),Yt){if(t.nodeName){const e=se(t.nodeName);if(!_t[e]||Tt[e])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof E)n=ge("\x3c!----\x3e"),o=n.ownerDocument.importNode(t,!0),o.nodeType===$&&"BODY"===o.nodeName||"HTML"===o.nodeName?n=o:n.appendChild(o);else{if(!Mt&&!At&&!jt&&-1===t.indexOf("<"))return it&&Ft?it.createHTML(t):t;if(n=ge(t),!n)return Mt?null:Ft?at:""}n&&Bt&&we(n.firstChild);const c=be(Yt?t:n);for(;i=c.nextNode();)ke(i)||(i.content instanceof u&&Re(i.content),Te(i));if(Yt)return t;if(Mt){if(Wt)for(s=ut.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return(kt.shadowroot||kt.shadowrootmode)&&(s=ft.call(a,s,!0)),s}let f=jt?n.outerHTML:n.innerHTML;return jt&&_t["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&b(q,n.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+f),At&&l([ht,dt,mt],(t=>{f=y(f,t," ")})),it&&Ft?it.createHTML(f):f},r.setConfig=function(){fe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Nt=!0},r.clearConfig=function(){ce=null,Nt=!1},r.isValidAttribute=function(t,e,n){ce||fe({});const r=se(t),o=se(e);return Pe(r,o,n)},r.addHook=function(t,e){"function"==typeof e&&(pt[t]=pt[t]||[],p(pt[t],e))},r.removeHook=function(t){if(pt[t])return f(pt[t])},r.removeHooks=function(t){pt[t]&&(pt[t]=[])},r.removeAllHooks=function(){pt={}},r}()}()}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{getDueDate:()=>P,getOWSettings:()=>O,getPostInWorkflow:()=>R,getUserCapabilities:()=>T});var e={};n.r(e),n.d(e,{fetchOWSettings:()=>L,fetchUserCapabilities:()=>C,setDueDate:()=>x,setIsPostInWorkflow:()=>I,setOWSettings:()=>D,setUserCapabilities:()=>A});const r=window.wp.i18n,o=window.wp.element;function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){return e.reduce((function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e}),{})}function s(t){return null==t||0===t.length||"object"===i(t)&&0===Object.keys(t).length}function c(){var t=new URLSearchParams(window.location.search);if(null==(t=t.get("oasiswf"))){var e=document.getElementById("hi_oasiswf_id");return void 0===e||null==e?null:e.value}return t}function u(){return new URLSearchParams(window.location.search).get("user")}function l(t){var e=[],n=(0,r.__)("Complete","oasisworkflow"),o=(0,r.__)("Unable to Complete","oasisworkflow");return"review"==t&&(n=(0,r.__)("Approved","oasisworkflow"),o=(0,r.__)("Reject","oasisworkflow")),e.push({label:"",value:""},{label:n,value:"complete"},{label:o,value:"unable"}),e}function f(t){for(var e=t.assignees,n=[],r=[],o=t.assignToAll,i="",s=0;s<e.length;s++)-1!==e[s].name.indexOf("Post Author")&&(i=e[s]);e.sort((function(t,e){return t===i?-1:e===i?1:0}));var c=e.map((function(t){return a(t,["ID","name"])}));if(c.map((function(t){n.push({label:t.name,value:t.ID})})),1==n.length&&(r=[n[0].value]),o){var u=[];c.map((function(t){u.push(t.ID)})),r=u}return{availableAssignees:n,selectedAssignees:r}}var p=(0,o.createElement)("svg",{width:20,height:20},(0,o.createElement)("path",{d:"M20,11.647c0-5.204-4.478-9.424-10-9.424c-5.523,0-10,4.22-10,9.424c0,0.594,0.061,1.174,0.172,1.734c0.077-5.232,4.371-9.449,9.659-9.449c5.337,0,9.664,4.295,9.664,9.593c0,0.182-0.008,0.362-0.019,0.541l0.199-0.037C19.886,13.268,20,12.47,20,11.647z"}),(0,o.createElement)("polygon",{points:"7.471,9.916 9.197,12.597 6.949,18 3.876,18 \t"}),(0,o.createElement)("polygon",{points:"15.553,10.996 12.732,18 15.911,18 17.868,12.219 \t"}),(0,o.createElement)("polygon",{points:"14.355,11.07 17.818,8.699 18.838,12.771 \t"}),(0,o.createElement)("polygon",{points:"7.484,9.762 10.317,9.767 15.911,17.674 12.74,17.674 \t"}),(0,o.createElement)("polygon",{points:"0.379,12.984 1.659,9.94 6.964,17.674 3.876,17.674 \t"}));const h=window.wp.data,d=window.wp.apiFetch;var m=n.n(d);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return(e=function(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b={dueDate:new Date},S={owSettings:{}},_={userCap:{}},E={isPostInWorkflow:!1};const k=(0,h.combineReducers)({dueDateReducer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,e=arguments.length>1?arguments[1]:void 0;return"SET_DUE_DATE"===e.type?v(v({},t),{},{dueDate:e.dueDate}):t},owSettingsReducer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,e=arguments.length>1?arguments[1]:void 0;return"SET_OW_SETTINGS"===e.type?v(v({},t),{},{owSettings:e.owSettings}):t},userCapabilitiesReducer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,e=arguments.length>1?arguments[1]:void 0;return"SET_USER_CAPABILITIES"===e.type?v(v({},t),{},{userCap:e.userCap}):t},postInWorkflowReducer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,e=arguments.length>1?arguments[1]:void 0;return"SET_POST_IS_IN_WORKFLOW"===e.type?v(v({},t),{},{isPostInWorkflow:e.isPostInWorkflow}):t}});function P(t){return t.dueDateReducer.dueDate}function O(t){return t.owSettingsReducer.owSettings}function T(t){return t.userCapabilitiesReducer.userCap}function R(t){return t.postInWorkflowReducer.isPostInWorkflow}function x(t){return{type:"SET_DUE_DATE",dueDate:t.dueDate}}function L(t){return{type:"FETCH_OW_SETTINGS",path:t}}function D(t){return{type:"SET_OW_SETTINGS",owSettings:t}}function C(t){return{type:"FETCH_USER_CAPABILITIES",path:t}}function A(t){return{type:"SET_USER_CAPABILITIES",userCap:t}}function I(t){var e=!1;return"1"==t.isPostInWorkflow&&(e=!0),{type:"SET_POST_IS_IN_WORKFLOW",isPostInWorkflow:e}}function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function N(){N=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,a=Object.create(i.prototype),s=new L(r||[]);return o(a,"_invoke",{value:O(t,n,s)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function w(){}function v(){}function g(){}var b={};u(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==n&&r.call(_,a)&&(b=_);var E=g.prototype=w.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(o,i,a,s){var c=f(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==j(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(j(e)+" is not iterable")}return v.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new P(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}var B=(0,h.createReduxStore)("plugin/oasis-workflow",{reducer:k,selectors:t,actions:e,controls:{FETCH_OW_SETTINGS:function(t){return m()({path:t.path})},FETCH_USER_CAPABILITIES:function(t){return m()({path:t.path})}},resolvers:{getOWSettings:N().mark((function t(){var e;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,L("/oasis-workflow/v1/settings");case 3:return e=t.sent,t.abrupt("return",D(e));case 5:case"end":return t.stop()}}),t)})),getUserCapabilities:N().mark((function t(){var e;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,C("/oasis-workflow/v1/usercap");case 3:return e=t.sent,t.abrupt("return",A(e));case 5:case"end":return t.stop()}}),t)}))}});(0,h.register)(B);const M=window.wp.editor,W=window.wp.compose,F=window.wp.components,U=window.wp.plugins;var G=n(838),H=n.n(G);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function z(){z=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,a=Object.create(i.prototype),s=new L(r||[]);return o(a,"_invoke",{value:O(t,n,s)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function w(){}function v(){}function g(){}var b={};u(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==n&&r.call(_,a)&&(b=_);var E=g.prototype=w.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(o,i,a,s){var c=f(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Y(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Y(e)+" is not iterable")}return v.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new P(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Q(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var e=function(t){if("object"!=Y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:e+""}function V(t,e,n){return e=K(e),function(t,e){if(e&&("object"==Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$()?Reflect.construct(e,n||[],K(t).constructor):e.apply(t,n))}function $(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($=function(){return!!t})()}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}function Z(t,e){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Z(t,e)}var J=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=V(this,e,arguments)).state={buttonText:(0,r.__)("Abort Workflow","oasisworkflow"),hideButton:!0,isOpen:!1,isBusy:!1,comments:"",success:[],submitSpinner:"hide",submitButtonDisable:!1},t.handleWorkflowAbort=t.handleWorkflowAbort.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z(t,e)}(e,t),n=e,o=[{key:"showAbortDialog",value:function(){this.setState({isOpen:!0})}},{key:"handleWorkflowAbort",value:function(t){var e=this;this.setState({isBusy:!0,submitButtonDisable:!0,submitSpinner:"show"});var n={post_id:this.props.postId,comments:this.state.comments};m()({path:"/oasis-workflow/v1/workflows/abort/",method:"POST",data:n}).then((function(t){var n=[];n.push(t.success_response),e.setState({success:n,isBusy:!1}),""!==t.redirect_link&&(window.location.href=H().sanitize(t.redirect_link))}),(function(t){return console.log(t),t}))}},{key:"handleClose",value:(i=z().mark((function t(){return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({isOpen:!1}),t.next=3,this.props.onSave();case 3:this.props.handleResponse();case 4:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){Q(o,n,r,a,s,"next",t)}function s(t){Q(o,n,r,a,s,"throw",t)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"componentDidMount",value:function(){var t=this.props,e=t.userCap,n=t.owSettings;if(e.user_can.ow_abort_workflow){var r=n.terminology_settings.oasiswf_custom_workflow_terminology,o=this.state.buttonText;r&&(o=n.terminology_settings.oasiswf_custom_workflow_terminology.abortWorkflowText),this.setState({buttonText:o,hideButton:!1,success:[],isBusy:!1})}}},{key:"render",value:function(){var t=this,e=this.state,n=e.hideButton,o=e.isOpen,i=e.success,a=e.buttonText,s=e.submitButtonDisable,c=e.submitSpinner,u=this.props.isPostInWorkflow;return n||!u?"":React.createElement(F.PanelBody,null,React.createElement(F.Button,{focus:"true",onClick:this.showAbortDialog.bind(this),isLink:!0},a),o&&React.createElement(F.Modal,{title:a,onRequestClose:function(){return t.setState({isOpen:!1})}},0!==i.length?React.createElement("div",null,React.createElement("div",{id:"owf-success-message",className:"notice notice-success is-dismissible"},i.map((function(t){return React.createElement("p",{key:t},t)}))),React.createElement(F.PanelRow,null,React.createElement(F.Button,{isPrimary:!0,focus:"true",onClick:this.handleClose.bind(this)},(0,r.__)("Close","oasisworkflow")))):React.createElement("form",{className:"reusable-block-edit-panel",onSubmit:this.handleWorkflowAbort},React.createElement(F.TextareaControl,{label:(0,r.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(e){return t.setState({comments:e})}}),React.createElement(F.PanelRow,null,React.createElement(F.Button,{isLink:!0,onClick:function(){return t.setState({isOpen:!1})}},(0,r.__)("Cancel","oasisworkflow")),React.createElement(F.Button,{type:"submit",isBusy:this.state.isBusy,isPrimary:!0,disabled:s,focus:"true"},a),"show"==c?React.createElement(F.Spinner,null):""))))}}],o&&q(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,i,a}(o.Component);const tt=(0,W.compose)([(0,h.withSelect)((function(t){var e=t("core/editor"),n=e.getCurrentPostId,r=e.getEditedPostAttribute,o=t("plugin/oasis-workflow"),i=o.getOWSettings,a=o.getUserCapabilities,s=o.getPostInWorkflow;return{postId:n(),postMeta:r("meta"),owSettings:i(),userCap:a(),isPostInWorkflow:s()}})),(0,h.withDispatch)((function(t){return{onSave:t("core/editor").savePost}}))])(J),et=window.wp.date,nt=(0,W.compose)([(0,h.withSelect)((function(t){return{dueDate:(0,t("plugin/oasis-workflow").getDueDate)()}})),(0,h.withDispatch)((function(t){return{onUpdateDate:function(e){t("plugin/oasis-workflow").setDueDate({dueDate:e})}}}))])((function(t){var e=t.dueDate,n=t.onUpdateDate;return React.createElement(F.DateTimePicker,{key:"ow-date-picker",onChange:n,currentDate:e})})),rt=(0,h.withSelect)((function(t){return{date:t("plugin/oasis-workflow").getDueDate()}}))((function(t){var e=t.date;return(0,et.dateI18n)("M d, Y",e)}));function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,at(r.key),r)}}function at(t){var e=function(t){if("object"!=ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ot(e)?e:e+""}function st(t,e,n){return e=ut(e),function(t,e){if(e&&("object"==ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ct()?Reflect.construct(e,n||[],ut(t).constructor):e.apply(t,n))}function ct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ct=function(){return!!t})()}function ut(t){return ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ut(t)}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}var ft=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=st(this,e,arguments)).state={priorityLabel:(0,r.__)("Priority","oasisworkflow"),priorities:[],displayPriority:"",prioritySpinner:"hide"},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(e,t),n=e,(o=[{key:"componentDidMount",value:function(){var t=this,e=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology,n=this.props.owSettings.workflow_settings;if(e){var r=e.taskPriorityText;this.setState({priorityLabel:r})}if(n){var o=n.oasiswf_priority_setting;this.setState({displayPriority:o,prioritySpinner:"show"})}m()({path:"/oasis-workflow/v1/priorities",method:"GET"}).then((function(e){var n=e.map((function(t){return a(t,["key","value"])})),r=[];return n.map((function(t){r.push({label:t.value,value:t.key})})),t.setState({priorities:r,prioritySpinner:"hide"}),e}),(function(t){return console.log(t),t}))}},{key:"render",value:function(){var t=this.state,e=t.priorityLabel,n=t.displayPriority;return React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==this.state.prioritySpinner?React.createElement(F.Spinner,null):""),"enable_priority"===n?React.createElement(F.SelectControl,{label:e+":",value:this.props.value,options:this.state.priorities,onChange:this.props.onChange}):"")}}])&&it(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(o.Component);const pt=(0,W.compose)([(0,h.withSelect)((function(t){return{owSettings:(0,t("plugin/oasis-workflow").getOWSettings)()}}))])(ft);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mt(r.key),r)}}function mt(t){var e=function(t){if("object"!=ht(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ht(e)?e:e+""}function yt(t,e,n){return e=vt(e),function(t,e){if(e&&("object"==ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wt()?Reflect.construct(e,n||[],vt(t).constructor):e.apply(t,n))}function wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wt=function(){return!!t})()}function vt(t){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vt(t)}function gt(t,e){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gt(t,e)}var bt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yt(this,e,arguments)).state={workflows:[],workflowSpinner:"show"},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gt(t,e)}(e,t),n=e,(o=[{key:"componentDidMount",value:function(){var t=this,e=this.props.postId;m()({path:"/oasis-workflow/v1/workflows/postId="+e,method:"GET"}).then((function(e){var n=e.map((function(t){return a(t,["ID","name","version"])})),r=[];return n.length>1&&r.push({label:"",value:""}),n.map((function(e){1==e.version?r.push({label:e.name,value:e.ID}):r.push({label:e.name+" ("+e.version+")",value:e.ID}),1==n.length&&t.props.onChange(e.ID)})),t.setState({workflows:r,workflowSpinner:"hide"}),e}),(function(t){return console.log(t),t}))}},{key:"render",value:function(){return React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==this.state.workflowSpinner?React.createElement(F.Spinner,null):""),React.createElement(F.SelectControl,{label:(0,r.__)("Select Workflow","oasisworkflow")+":",value:this.props.value,options:this.state.workflows,onChange:this.props.onChange}))}}])&&dt(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(o.Component);const St=(0,W.compose)([(0,h.withSelect)((function(t){return{postId:(0,t("core/editor").getCurrentPostId)()}}))])(bt);function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function Et(t){return function(t){if(Array.isArray(t))return kt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return kt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Pt(){Pt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,a=Object.create(i.prototype),s=new L(r||[]);return o(a,"_invoke",{value:O(t,n,s)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function w(){}function v(){}function g(){}var b={};u(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==n&&r.call(_,a)&&(b=_);var E=g.prototype=w.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(o,i,a,s){var c=f(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_t(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(_t(e)+" is not iterable")}return v.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new P(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Ot(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function Tt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ot(i,r,o,a,s,"next",t)}function s(t){Ot(i,r,o,a,s,"throw",t)}a(void 0)}))}}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,It(r.key),r)}}function xt(t,e,n){return e=Dt(e),function(t,e){if(e&&("object"==_t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Lt()?Reflect.construct(e,n||[],Dt(t).constructor):e.apply(t,n))}function Lt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Lt=function(){return!!t})()}function Dt(t){return Dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dt(t)}function Ct(t,e){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ct(t,e)}function At(t,e,n){return(e=It(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function It(t){var e=function(t){if("object"!=_t(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_t(e)?e:e+""}var jt=(0,et.getSettings)(),Nt=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),At(t=xt(this,e,arguments),"checkPostSaving",(function(){var e=(0,h.select)("core/editor").isSavingPost();t.setState({isSaving:e})})),At(t,"processSignoffQueue",Tt(Pt().mark((function e(){var n,r,o;return Pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.state.signoffQueue.length){e.next=5;break}return n=function(){return new Promise((function(e){var n=setInterval((function(){t.state.isSaving||(clearInterval(n),e())}),100)}))},e.next=4,n();case 4:return e.abrupt("return");case 5:return r=t.state.signoffQueue[0],o=function(){return new Promise((function(e){var n=setInterval((function(){t.state.isSaving||(clearInterval(n),e())}),100)}))},e.next=9,o();case 9:return e.next=11,t.handleSubmitToWorkflowCB(r);case 11:t.setState((function(t){return{signoffQueue:t.signoffQueue.slice(1)}}),(function(){t.processSignoffQueue()}));case 12:case"end":return e.stop()}}),e)})))),t.submitToWorkflowPanelRef=(0,o.createRef)();var n=[];return n.push({label:"",value:""}),t.state={workflowButtonText:(0,r.__)("Submit to Workflow","oasisworkflow"),assignActorLabel:(0,r.__)("Assign Actor(s)","oasisworkflow"),publishDateLabel:(0,r.__)("Publish Date","oasisworkflow"),dueDateLabel:(0,r.__)("Due Date","oasisworkflow"),displayPublishDate:"",displayDueDate:"",selectedWorkflow:"",firstSteps:n,selectedFirstStep:"",selectedPriority:"2normal",assignee:[],selectedAssignees:[],publishDate:(0,et.dateI18n)(jt.formats.datetimeAbbreviated,new Date),comments:"",assignToAll:!1,validationErrors:[],hideForm:!1,redirectingLoader:"hide",stepSpinner:"hide",assigneeSpinner:"hide",submitSpinner:"hide",isSaving:!1,signoffQueue:[],submitButtonDisable:!1},t.unsubscribe=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ct(t,e)}(e,t),n=e,i=[{key:"componentDidMount",value:function(){var t=this,e=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology,n=this.props.owSettings.workflow_settings;if(e){var r=e.submitToWorkflowText,o=e.assignActorsText,i=e.publishDateText,a=e.dueDateText;this.setState({workflowButtonText:r,assignActorLabel:o,publishDateLabel:i,dueDateLabel:a})}if(n){var s=n.oasiswf_publish_date_setting,c=n.oasiswf_default_due_days,u=new Date;""!==c&&u.setDate(u.getDate()+parseInt(c)),this.props.setDueDate({dueDate:u}),this.setState({displayPublishDate:s,displayDueDate:c})}this.unsubscribe=(0,h.subscribe)((function(){t.checkPostSaving()}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getFirstStep",value:function(t){var e=this,n=this.props.postId;this.setState({selectedWorkflow:t,validationErrors:[],stepSpinner:"show",assigneeSpinner:"show"}),m()({path:"/oasis-workflow/v1/workflows/submit/firstStep/workflowId="+t+"/postId="+n,method:"GET"}).then((function(t){var n,o=t.step_id,i=t.step_label,a=[],s=1===t.assign_to_all,c=[];a.push({label:i,value:o});var u=new Date;t.due_days&&u.setDate(u.getDate()+parseInt(t.due_days)),e.props.setDueDate({dueDate:u});var l=t.users;if(0===l.length)return c.push((0,r.__)("No users found to assign the task.","oasisworkflow")),e.setState({firstSteps:a,selectedFirstStep:o,validationErrors:c,assignee:[]}),void e.submitToWorkflowPanelRef.current.scrollIntoView();var p=f({assignees:l,assignToAll:s});return n=p.availableAssignees,e.setState({firstSteps:a,selectedFirstStep:o,assignee:n,selectedAssignees:p.selectedAssignees,assignToAll:s,stepSpinner:"hide",assigneeSpinner:"hide"}),t}),(function(t){return console.log(t),t}))}},{key:"handleOnPriorityChange",value:function(t){this.setState({selectedPriority:t})}},{key:"validateSubmitToWorkflow",value:(u=Tt(Pt().mark((function t(e){var n,o,i,a,s;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],o=new Date,o=moment(o).format("YYYY-MM-DD"),i=moment(e.due_date).format("YYYY-MM-DD"),a=this.state.selectedWorkflow,s=this.state.selectedFirstStep,""===a&&n.push((0,r.__)("Please select a workflow.","oasisworkflow")),""===s&&n.push((0,r.__)("Please select a step.","oasisworkflow")),""===e.due_date&&n.push((0,r.__)("Please enter a due date.","oasisworkflow")),""!==e.due_date&&1==moment(o).isAfter(i)&&n.push((0,r.__)("Due date must be greater than the current date.","oasisworkflow")),0!==e.assignees.length||this.state.assignToAll||n.push((0,r.__)("No assigned actor(s).","oasisworkflow")),void 0===window.acf){t.next=16;break}return t.next=14,window.workflowSubmitWithACF();case 14:"invalid"===t.sent&&n.push((0,r.__)("Please enter ACF required fields.","oasisworkflow"));case 16:return t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,this)}))),function(_x){return u.apply(this,arguments)})},{key:"handleSubmitToWorkflow",value:(c=Tt(Pt().mark((function t(e){var n=this;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),this.setState({validationErrors:[]}),this.setState((function(t){return{signoffQueue:[].concat(Et(t.signoffQueue),[e])}}),(function(){n.processSignoffQueue()}));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"handleSubmitToWorkflowCB",value:(s=Tt(Pt().mark((function t(e){var n,r,o=this;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({submitSpinner:"show",submitButtonDisable:!0}),n={post_id:this.props.postId,step_id:this.state.selectedFirstStep,priority:this.state.selectedPriority,assignees:this.state.selectedAssignees,due_date:this.props.dueDate,publish_date:this.props.publishDate,comments:this.state.comments},t.prev=2,t.next=5,this.props.onSave();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),"rest_forbidden_context"===t.t0.code?console.error("Permission error:",t.t0.message):console.error("An unexpected error occurred:",t.t0);case 10:return t.next=12,this.validateSubmitToWorkflow(n);case 12:if(!((r=t.sent).length>0)){t.next=17;break}return this.setState({validationErrors:r,submitSpinner:"hide",submitButtonDisable:!1}),this.submitToWorkflowPanelRef.current.scrollIntoView(),t.abrupt("return");case 17:this.setState({validationErrors:[]}),this.setState({isSaving:!0},Tt(Pt().mark((function t(){return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.processSignoffQueue();case 2:if(o.state.isSaving){t.next=5;break}return t.next=5,o.invokeSubmitToWorkflowAPI(n);case 5:case"end":return t.stop()}}),t)}))));case 19:case"end":return t.stop()}}),t,this,[[2,7]])}))),function(t){return s.apply(this,arguments)})},{key:"invokeSubmitToWorkflowAPI",value:(a=Tt(Pt().mark((function t(e){var n=this;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:return t.next=4,m()({path:"/oasis-workflow/v1/workflows/submit/",method:"POST",data:e}).then((function(t){n.setState({hideForm:!0,redirectingLoader:"show"}),""!==t.redirect_link?window.location.href=H().sanitize(t.redirect_link):n.props.handleResponse(t)}),(function(t){return console.log(t),t}));case 4:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"render",value:function(){var t=this,e=this.props,n=e.isSaving,i=e.isCurrentPostPublished,a=e.isCurrentPostScheduled,s=(e.postStatus,e.isPostInWorkflow),c=e.postMeta,u=this.state,l=u.validationErrors,f=u.hideForm,p=u.workflowButtonText,h=u.assignActorLabel,d=u.publishDateLabel,m=u.dueDateLabel,y=u.displayPublishDate,w=u.displayDueDate,v=u.redirectingLoader,g=u.stepSpinner,b=u.assigneeSpinner,S=u.submitSpinner,_=u.submitButtonDisable;return f&&"show"===v?React.createElement("div",null,React.createElement(F.PanelBody,null,(0,r.__)("redirecting...","oasisworkflow"))):c&&"1"==c._oasis_is_in_workflow||s||f||i||a?"":React.createElement(F.PanelBody,{ref:this.submitToWorkflowPanelRef,initialOpen:!0,title:p},React.createElement("form",{className:"reusable-block-edit-panel"},0!==l.length?React.createElement("div",{id:"owf-error-message",className:"notice notice-error is-dismissible"},l.map((function(t){return React.createElement("p",{key:t},t)}))):"",React.createElement(St,{value:this.state.selectedWorkflow,onChange:this.getFirstStep.bind(this)}),React.createElement("div",{className:"owf-spinner"},"show"==g?React.createElement(F.Spinner,null):""),React.createElement(F.SelectControl,{label:(0,r.__)("Step","oasisworkflow")+":",value:this.state.selectedFirstStep,options:this.state.firstSteps,onChange:function(e){return t.setState({selectedFirstStep:e})}}),React.createElement(pt,{value:this.state.selectedPriority,onChange:this.handleOnPriorityChange.bind(this)}),React.createElement("div",{className:"owf-spinner"},"show"==b&&0==this.state.assignToAll?React.createElement(F.Spinner,null):""),this.state.assignToAll?"":React.createElement(F.SelectControl,{multiple:!0,className:"ow-multi-select",label:h+":",value:this.state.selectedAssignees,options:this.state.assignee,onChange:function(e){return t.setState({selectedAssignees:e})}}),""==y?React.createElement(F.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,d+":"," "),React.createElement(F.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog",renderToggle:function(t){var e=t.onToggle,n=t.isOpen;return React.createElement(o.Fragment,null,React.createElement(F.Button,{type:"button",onClick:e,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(M.PostScheduleLabel,null)))},renderContent:function(){return React.createElement(M.PostSchedule,null)}})):"",""!==w?React.createElement(F.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,m+":"," "),React.createElement(F.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog owduedatepicker-dropdown",renderToggle:function(t){var e=t.onToggle,n=t.isOpen;return React.createElement(o.Fragment,null,React.createElement(F.Button,{type:"button",onClick:e,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(rt,null)))},renderContent:function(){return React.createElement(nt,null)}})):"",React.createElement(F.PanelRow,null,React.createElement(F.TextareaControl,{label:(0,r.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(e){return t.setState({comments:e})}})),React.createElement(F.PanelRow,null,React.createElement(F.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:_,onClick:this.handleSubmitToWorkflow.bind(this)},p),React.createElement("div",{className:"owf-spinner"},"show"==S?React.createElement(F.Spinner,null):""))))}}],i&&Rt(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,a,s,c,u}(o.Component);const Bt=(0,W.compose)([(0,h.withSelect)((function(t){var e=t("core/editor"),n=e.getCurrentPostId,r=e.getEditedPostAttribute,o=e.isCurrentPostPublished,i=e.isCurrentPostScheduled,a=e.getCurrentPost,s=t("plugin/oasis-workflow"),c=s.getDueDate,u=s.getOWSettings,l=s.getPostInWorkflow,f=a(),p=f.status;return f.type,{postId:n(),postMeta:r("meta"),isCurrentPostPublished:o(),isCurrentPostScheduled:i(),publishDate:r("date"),dueDate:c(),owSettings:u(),postStatus:p,isPostInWorkflow:l()}})),(0,h.withDispatch)((function(t){return{onSave:t("core/editor").savePost,autosave:t("core/editor").autosave,setDueDate:t("plugin/oasis-workflow").setDueDate}}))])(Nt);function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ft(r.key),r)}}function Ft(t){var e=function(t){if("object"!=Mt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mt(e)?e:e+""}function Ut(t,e,n){return e=Ht(e),function(t,e){if(e&&("object"==Mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Gt()?Reflect.construct(e,n||[],Ht(t).constructor):e.apply(t,n))}function Gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Gt=function(){return!!t})()}function Ht(t){return Ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ht(t)}function Yt(t,e){return Yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yt(t,e)}var zt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ut(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yt(t,e)}(e,t),n=e,(o=[{key:"handleRedirectToListPage",value:function(){"post"===this.props.postType?window.location.href="edit.php":window.location.href="edit.php?post_type="+this.props.postType}},{key:"handleRedirectToInboxPage",value:function(){window.location.href="admin.php?page=oasiswf-inbox"}},{key:"render",value:function(){var t;return s("string"==typeof(t=this.props.response)?t.trim():t)?"":React.createElement("div",null,React.createElement(F.PanelBody,null,React.createElement("div",{id:"owf-success-message",className:"notice notice-success is-dismissible"},this.props.response)),React.createElement(F.PanelBody,null,React.createElement(F.PanelRow,null,React.createElement("p",{className:"post-publish-panel__postpublish-subheader"},React.createElement("strong",null,(0,r.__)("Whats next?","oasisworkflow")))),React.createElement(F.PanelRow,null,React.createElement(F.Button,{focus:"true",onClick:this.handleRedirectToListPage.bind(this),isLink:!0},(0,r.__)("Take me to List page","oasisworkflow"))),React.createElement(F.PanelRow,null,React.createElement(F.Button,{focus:"true",onClick:this.handleRedirectToInboxPage.bind(this),isLink:!0},(0,r.__)("Take me to Workflow Inbox","oasisworkflow")))))}}])&&Wt(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(o.Component);const Qt=(0,W.compose)([(0,h.withSelect)((function(t){return{postType:(0,t("core/editor").getCurrentPostType)()}}))])(zt);function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vt(r.key),r)}}function Vt(t){var e=function(t){if("object"!=qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qt(e)?e:e+""}function $t(t,e,n){return e=Zt(e),function(t,e){if(e&&("object"==qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Kt()?Reflect.construct(e,n||[],Zt(t).constructor):e.apply(t,n))}function Kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Kt=function(){return!!t})()}function Zt(t){return Zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zt(t)}function Jt(t,e){return Jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Jt(t,e)}var te=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=$t(this,e,arguments)).state={isBusy:!1,success:[],responseErrors:[],hideClaim:!1,submitSpinner:"hide",submitButtonDisable:!1},t.handleClaim=t.handleClaim.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jt(t,e)}(e,t),n=e,(o=[{key:"handleClaim",value:function(t){var e=this;this.setState({isBusy:!0,submitSpinner:"show",submitButtonDisable:!0});var n=this.props.postId,r={post_id:n,history_id:this.props.actionHistoryId};m()({path:"/oasis-workflow/v1/workflows/claim/",method:"POST",data:r}).then((function(t){var r=[];if("true"===t.isError)return r.push(t.errorMessage),void e.setState({responseErrors:r,hideClaim:!0});if("false"===t.isError){var o=t.new_history_id,i=t.url;window.location.href=i+"post.php?post="+n+"&action=edit&oasiswf="+o}}),(function(t){return console.log(t),t}))}},{key:"componentDidMount",value:function(){this.setState({isBusy:!1})}},{key:"render",value:function(){var t=this.state,e=t.responseErrors,n=(t.hideClaim,t.submitSpinner),o=t.submitButtonDisable;return React.createElement("div",null,0!==e.length?React.createElement("div",{id:"owf-error-message",className:"notice notice-error is-dismissible"},e.map((function(t){return React.createElement("p",{key:t},t)}))):"",this.props.isHidden?"":React.createElement(F.PanelBody,null,React.createElement(F.Button,{focus:"true",isPrimary:!0,disabled:o,onClick:this.handleClaim},(0,r.__)("Claim","oasisworkflow")),"show"==n?React.createElement(F.Spinner,null):""))}}])&&Xt(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(o.Component);const ee=(0,h.withSelect)((function(t){return{postId:(0,t("core/editor").getCurrentPostId)()}}))(te);function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function re(t){return function(t){if(Array.isArray(t))return oe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return oe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ie(){ie=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,a=Object.create(i.prototype),s=new L(r||[]);return o(a,"_invoke",{value:O(t,n,s)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function w(){}function v(){}function g(){}var b={};u(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==n&&r.call(_,a)&&(b=_);var E=g.prototype=w.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(o,i,a,s){var c=f(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==ne(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(ne(e)+" is not iterable")}return v.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new P(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function ae(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function se(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ae(i,r,o,a,s,"next",t)}function s(t){ae(i,r,o,a,s,"throw",t)}a(void 0)}))}}function ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,de(r.key),r)}}function ue(t,e,n){return e=fe(e),function(t,e){if(e&&("object"==ne(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,le()?Reflect.construct(e,n||[],fe(t).constructor):e.apply(t,n))}function le(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(le=function(){return!!t})()}function fe(t){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fe(t)}function pe(t,e){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pe(t,e)}function he(t,e,n){return(e=de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function de(t){var e=function(t){if("object"!=ne(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ne(e)?e:e+""}var me=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),he(t=ue(this,e,arguments),"checkPostSaving",(function(){var e=(0,h.select)("core/editor").isSavingPost();t.setState({isSaving:e})})),he(t,"processSignoffQueue",se(ie().mark((function e(){var n,r,o;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.state.signoffQueue.length){e.next=5;break}return n=function(){return new Promise((function(e){var n=setInterval((function(){t.state.isSaving||(clearInterval(n),e())}),100)}))},e.next=4,n();case 4:return e.abrupt("return");case 5:return r=t.state.signoffQueue[0],o=function(){return new Promise((function(e){var n=setInterval((function(){t.state.isSaving||(clearInterval(n),e())}),100)}))},e.next=9,o();case 9:return e.next=11,t.handleWorkflowCompleteCB(r);case 11:t.setState((function(t){return{signoffQueue:t.signoffQueue.slice(1)}}),(function(){t.processSignoffQueue()}));case 12:case"end":return e.stop()}}),e)})))),t.state={signoffButtonText:(0,r.__)("Sign Off","oasisworkflow"),comments:"",actionHistoryId:c(),taskUser:u(),isImmediatelyChecked:!1,originalPublishDate:t.props.publishDate,redirectingLoader:"hide",submitSpinner:"hide",isSaving:!1,signoffQueue:[],submitButtonDisable:!1},t.unsubscribe=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pe(t,e)}(e,t),n=e,i=[{key:"componentDidMount",value:function(){var t=this,e=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology;if(e){var n=e.signOffText;this.setState({signoffButtonText:n})}this.unsubscribe=(0,h.subscribe)((function(){t.checkPostSaving()}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"validateSignoff",value:(f=se(ie().mark((function t(e){var n;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],void 0===window.acf){t.next=6;break}return t.next=4,window.workflowSubmitWithACF();case 4:"invalid"===t.sent&&n.push((0,r.__)("Please enter ACF required fields.","oasisworkflow"));case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)}))),function(_x){return f.apply(this,arguments)})},{key:"handleWorkflowComplete",value:(l=se(ie().mark((function t(e){var n=this;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),this.setState({validationErrors:[]}),this.setState((function(t){return{signoffQueue:[].concat(re(t.signoffQueue),[e])}}),(function(){n.processSignoffQueue()}));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"handleWorkflowCompleteCB",value:(s=se(ie().mark((function t(e){var n,r=this;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({submitSpinner:"show",submitButtonDisable:!0}),n={post_id:this.props.postId,history_id:this.state.actionHistoryId,immediately:this.state.isImmediatelyChecked,task_user:this.state.taskUser,publish_datetime:this.props.publishDate},t.prev=2,t.next=5,this.props.onSave();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),"rest_forbidden_context"===t.t0.code?console.error("Permission error:",t.t0.message):console.error("An unexpected error occurred:",t.t0);case 10:return t.next=12,this.validateSignoff(n);case 12:if(!(t.sent.length>0)){t.next=16;break}return this.setState({submitSpinner:"hide",submitButtonDisable:!1}),t.abrupt("return");case 16:this.setState({isSaving:!0},se(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.processSignoffQueue();case 2:if(r.state.isSaving){t.next=5;break}return t.next=5,r.invokeSignoffAPI(n);case 5:case"end":return t.stop()}}),t)}))));case 17:case"end":return t.stop()}}),t,this,[[2,7]])}))),function(t){return s.apply(this,arguments)})},{key:"redirectTrigger",value:function(t){this.setState({redirectingLoader:"show"}),window.location.href=H().sanitize(t)}},{key:"refreshTrigger",value:function(t){this.props.handleResponse(t),this.props.pageRefresh()}},{key:"invokeSignoffAPI",value:function(t){var e=this;m()({path:"/oasis-workflow/v1/workflows/signoff/workflowComplete/",method:"POST",data:t}).then((function(t){var n=new CustomEvent("ow_workflow_completed",{detail:t});if(document.dispatchEvent(n),""!==t.redirect_link){var r=function(){var n=se(ie().mark((function n(){return ie().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.props.editPost({status:t.new_post_status});case 2:return n.next=4,e.props.onSave();case 4:e.redirectTrigger(t.redirect_link);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();r()}else{var o=function(){var n=se(ie().mark((function n(){return ie().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.props.editPost({status:t.new_post_status});case 2:return n.next=4,e.props.onSave();case 4:e.refreshTrigger(t);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();o()}}),(function(t){return console.log(t),t}))}},{key:"handleWorkflowCancel",value:function(t){var e=this;this.setState({submitSpinner:"show",submitButtonDisable:!0});var n={post_id:this.props.postId,history_id:this.state.actionHistoryId,comments:this.state.comments,task_user:this.state.taskUser};m()({path:"/oasis-workflow/v1/workflows/signoff/workflowCancel/",method:"POST",data:n}).then((function(t){e.props.handleResponse(t)}),(function(t){return console.log(t),t}))}},{key:"onImmediatelyChange",value:(a=se(ie().mark((function t(e){var n,r;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Date,r="",e?(this.setState({isImmediatelyChecked:!0}),r=n):(this.setState({isImmediatelyChecked:!1}),r=this.state.originalPublishDate),this.props.editPost({date:r}),t.next=6,this.props.onSave();case 6:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"render",value:function(){var t=this,e=this.props,n=e.isSaving,i=(e.postMeta,this.state),a=i.isImmediatelyChecked,s=i.signoffButtonText,c=i.redirectingLoader,u=i.submitSpinner,l=i.submitButtonDisable;return"show"===c?React.createElement("div",null,React.createElement(F.PanelBody,null,(0,r.__)("redirecting...","oasisworkflow"))):React.createElement("div",null,"success"===this.props.stepDecision?React.createElement("div",null,React.createElement(F.PanelRow,null,React.createElement("div",{id:"owf-success-message",className:"notice notice-warning is-dismissible"},React.createElement("p",null,(0,r.__)("This is the last step in the workflow. Are you sure to complete the workflow?","oasisworkflow")))),React.createElement(F.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,(0,r.__)("Publish","oasisworkflow")+":"," "),React.createElement(F.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog",renderToggle:function(t){var e=t.onToggle,n=t.isOpen;return React.createElement(o.Fragment,null,React.createElement(F.Button,{type:"button",onClick:e,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(M.PostScheduleLabel,null)))},renderContent:function(){return React.createElement(M.PostSchedule,null)}})),React.createElement(F.PanelRow,null,React.createElement(F.CheckboxControl,{label:(0,r.__)("Publish Immediately?","oasisworkflow"),checked:a,onChange:this.onImmediatelyChange.bind(this)})),React.createElement(F.PanelRow,null,React.createElement(F.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:l,onClick:this.handleWorkflowComplete.bind(this)},s),React.createElement("div",{className:"owf-spinner"},"show"==u?React.createElement(F.Spinner,null):""))):React.createElement("div",null,React.createElement(F.PanelRow,null,React.createElement("div",{id:"owf-success-message",className:"notice notice-error is-dismissible"},React.createElement("p",null,(0,r.__)("There are no further steps defined in the workflow. Do you want to cancel the post/page from the workflow?","oasisworkflow")))),React.createElement(F.PanelRow,null,React.createElement(F.TextareaControl,{label:(0,r.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(e){return t.setState({comments:e})}})),React.createElement(F.PanelRow,null,React.createElement(F.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:l,onClick:this.handleWorkflowCancel.bind(this)},s),React.createElement("div",{className:"owf-spinner"},"show"==u?React.createElement(F.Spinner,null):""))))}}],i&&ce(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,a,s,l,f}(o.Component);const ye=(0,W.compose)([(0,h.withSelect)((function(t){var e=t("core/editor"),n=e.getCurrentPostId,r=e.getEditedPostAttribute,o=t("plugin/oasis-workflow").getOWSettings;return{postId:n(),publishDate:r("date"),postMeta:r("meta"),owSettings:o()}})),(0,h.withDispatch)((function(t){return{onSave:t("core/editor").savePost,editPost:t("core/editor").editPost,autosave:t("core/editor").autosave,pageRefresh:t("core/editor").refreshPost}}))])(me);function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function ve(t){return function(t){if(Array.isArray(t))return ge(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ge(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function be(){be=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,a=Object.create(i.prototype),s=new L(r||[]);return o(a,"_invoke",{value:O(t,n,s)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function w(){}function v(){}function g(){}var b={};u(b,a,(function(){return this}));var S=Object.getPrototypeOf,_=S&&S(S(D([])));_&&_!==n&&r.call(_,a)&&(b=_);var E=g.prototype=w.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(o,i,a,s){var c=f(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==we(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=T(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?m:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(we(e)+" is not iterable")}return v.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new P(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Se(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function _e(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Se(i,r,o,a,s,"next",t)}function s(t){Se(i,r,o,a,s,"throw",t)}a(void 0)}))}}function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xe(r.key),r)}}function ke(t,e,n){return e=Oe(e),function(t,e){if(e&&("object"==we(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pe()?Reflect.construct(e,n||[],Oe(t).constructor):e.apply(t,n))}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Pe=function(){return!!t})()}function Oe(t){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oe(t)}function Te(t,e){return Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Te(t,e)}function Re(t,e,n){return(e=xe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xe(t){var e=function(t){if("object"!=we(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=we(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==we(e)?e:e+""}var Le=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Re(t=ke(this,e,arguments),"checkPostSaving",(function(){var e=(0,h.select)("core/editor").isSavingPost();t.setState({isSaving:e})})),Re(t,"processSignoffQueue",_e(be().mark((function e(){var n,r,o;return be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.state.signoffQueue.length){e.next=5;break}return n=function(){return new Promise((function(e){var n=setInterval((function(){t.state.isSaving||(clearInterval(n),e())}),100)}))},e.next=4,n();case 4:return e.abrupt("return");case 5:return r=t.state.signoffQueue[0],o=function(){return new Promise((function(e){var n=setInterval((function(){t.state.isSaving||(clearInterval(n),e())}),100)}))},e.next=9,o();case 9:return e.next=11,t.handleSignoffCB(r);case 11:t.setState((function(t){return{signoffQueue:t.signoffQueue.slice(1)}}),(function(){t.processSignoffQueue()}));case 12:case"end":return e.stop()}}),e)})))),t.signoffPanelRef=(0,o.createRef)(),t.state={signoffButtonText:(0,r.__)("Sign Off","oasisworkflow"),assignActorLabel:(0,r.__)("Assign Actor(s)","oasisworkflow"),dueDateLabel:(0,r.__)("Due Date","oasisworkflow"),displayDueDate:"",actions:[],selectedAction:"",signoffSteps:[{label:"",value:""}],selectedStep:"",selectedPriority:"2normal",assignee:[],selectedAssignees:[],assignToAll:!1,actionHistoryId:c(),taskUser:u(),comments:"",isLastStep:!1,lastStepDecision:"success",validationErrors:[],redirectingLoader:"hide",stepSpinner:"hide",assigneeSpinner:"hide",submitSpinner:"hide",isApiInProgress:!1,isSaving:!1,signoffQueue:[],isMakeAjaxRequest:!1,submitButtonDisable:!1},t.unsubscribe=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Te(t,e)}(e,t),n=e,i=[{key:"componentDidMount",value:function(){var t=this,e=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology,n=this.props.owSettings.workflow_settings;if(e){var r=e.signOffText,o=e.assignActorsText,i=e.dueDateText;this.setState({signoffButtonText:r,assignActorLabel:o,dueDateLabel:i})}if(n){var a=n.oasiswf_default_due_days,s=new Date;""!==a&&s.setDate(s.getDate()+parseInt(a)),this.props.setDueDate({dueDate:s}),this.setState({displayDueDate:a})}m()({path:"/oasis-workflow/v1/workflows/signoff/stepActions/actionHistoryId="+this.state.actionHistoryId,method:"GET"}).then((function(e){var n=e.process;t.setState({actions:l(n)})}),(function(t){return console.log(t),t})),this.unsubscribe=(0,h.subscribe)((function(){t.checkPostSaving()}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getSignoffSteps",value:function(t){var e=this,n=this.props.postId,o="success";this.setState({selectedAction:t,stepSpinner:"show"}),"complete"===t&&(o="success"),"unable"===t&&(o="failure"),m()({path:"/oasis-workflow/v1/workflows/signoff/nextSteps/actionHistoryId="+this.state.actionHistoryId+"/decision="+o+"/postId="+n,method:"GET"}).then((function(t){if(""===t.steps)e.setState({isLastStep:!0,lastStepDecision:o,stepSpinner:"hide"});else{e.setState({isLastStep:!1,lastStepDecision:"success"});var n=t.steps.map((function(t){return a(t,["step_id","step_name"])})),i=[];1!==n.length&&i.push({label:(0,r.__)("Select Step","oasisworkflow"),value:""}),n.map((function(t){i.push({label:t.step_name,value:t.step_id})})),e.setState({signoffSteps:i,stepSpinner:"hide"}),1==n.length&&(e.getSelectedStepDetails(i[0].value),e.setState({selectedStep:i[0].value}))}return t}),(function(t){return console.log(t),t}))}},{key:"getSelectedStepDetails",value:function(t){var e=this,n=this.props.postId;this.setState({selectedStep:t,assigneeSpinner:"show"}),m()({path:"/oasis-workflow/v1/workflows/signoff/stepDetails/actionHistoryId="+this.state.actionHistoryId+"/stepId="+t+"/postId="+n,method:"GET"}).then((function(t){var n,o=[],i=1===t.assign_to_all,a=t.users;if(e.props.setDueDate({dueDate:t.due_date}),0===a.length)return o.push((0,r.__)("No users found to assign the task.","oasisworkflow")),e.setState({validationErrors:o,assignee:[]}),void e.signoffPanelRef.current.scrollIntoView();var s=f({assignees:a,assignToAll:i});return n=s.availableAssignees,e.setState({assignee:n,assignToAll:i,selectedAssignees:s.selectedAssignees,assigneeSpinner:"hide"}),t}),(function(t){return console.log(t),t}))}},{key:"handleOnPriorityChange",value:function(t){this.setState({selectedPriority:t})}},{key:"validateSignoff",value:(y=_e(be().mark((function t(e){var n,o,i;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],o=new Date,o=moment(o).format("YYYY-MM-DD"),i=moment(e.due_date).format("YYYY-MM-DD"),""===e.step_id&&n.push((0,r.__)("Please select a step.","oasisworkflow")),""===e.due_date&&n.push((0,r.__)("Please enter a due date.","oasisworkflow")),""!==e.due_date&&1==moment(o).isAfter(i)&&n.push((0,r.__)("Due date must be greater than the current date.","oasisworkflow")),0!==e.assignees.length||this.state.assignToAll||n.push((0,r.__)("No assigned actor(s).","oasisworkflow")),void 0===window.acf){t.next=13;break}return t.next=11,window.workflowSubmitWithACF();case 11:"invalid"===t.sent&&n.push((0,r.__)("Please enter ACF required fields.","oasisworkflow"));case 13:return t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)}))),function(_x){return y.apply(this,arguments)})},{key:"handleSignoff",value:(d=_e(be().mark((function t(e){var n=this;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),this.setState({validationErrors:[]}),this.setState((function(t){return{signoffQueue:[].concat(ve(t.signoffQueue),[e])}}),(function(){n.processSignoffQueue()}));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"handleSignoffCB",value:(p=_e(be().mark((function t(e){var n,r,o=this;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({submitSpinner:"show",submitButtonDisable:!0}),n={post_id:this.props.postId,step_id:this.state.selectedStep,decision:this.state.selectedAction,priority:this.state.selectedPriority,assignees:this.state.selectedAssignees,due_date:this.props.dueDate,comments:this.state.comments,history_id:this.state.actionHistoryId,hideSignOff:!1,task_user:this.state.taskUser},t.prev=2,t.next=5,this.props.onSave();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),"rest_forbidden_context"===t.t0.code?console.error("Permission error:",t.t0.message):console.error("An unexpected error occurred:",t.t0);case 10:return t.next=12,this.validateSignoff(n);case 12:if(!((r=t.sent).length>0)){t.next=17;break}return this.setState({validationErrors:r,submitSpinner:"hide",submitButtonDisable:!1}),this.signoffPanelRef.current.scrollIntoView(),t.abrupt("return");case 17:this.setState({validationErrors:[]}),this.setState({isSaving:!0},_e(be().mark((function t(){return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.processSignoffQueue();case 2:if(o.state.isSaving){t.next=5;break}return t.next=5,o.invokeSignoffAPI(n);case 5:case"end":return t.stop()}}),t)}))));case 19:case"end":return t.stop()}}),t,this,[[2,7]])}))),function(t){return p.apply(this,arguments)})},{key:"invokeSignoffAPI",value:(s=_e(be().mark((function t(e){var n=this;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:if(!this.state.isMakeAjaxRequest){t.next=5;break}return console.log("invokeSignoffAPI request already running."),t.abrupt("return");case 5:return t.next=7,m()({path:"/oasis-workflow/v1/workflows/signoff/",method:"POST",data:e}).then((function(t){t.new_action_history_id!=n.state.actionHistoryId&&n.setState({hideSignOff:!0,redirectingLoader:"show"}),""!==t.redirect_link?window.location.href=H().sanitize(t.redirect_link):n.props.handleResponse(t),n.setState({isApiInProgress:!0,isMakeAjaxRequest:!0})}),(function(t){return console.log(t),n.setState({isApiInProgress:!0,isMakeAjaxRequest:!0}),t}));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"render",value:function(){var t=this,e=this.props,n=e.isSaving,i=e.isPostInWorkflow,a=this.state,s=a.validationErrors,c=a.isLastStep,u=a.lastStepDecision,l=a.hideSignOff,f=a.signoffButtonText,p=a.assignActorLabel,h=a.dueDateLabel,d=a.displayDueDate,m=a.redirectingLoader,y=a.stepSpinner,w=a.assigneeSpinner,v=a.submitSpinner,g=a.submitButtonDisable;return l&&"show"===m?React.createElement("div",null,React.createElement(F.PanelBody,null,(0,r.__)("redirecting...","oasisworkflow"))):!i||l?"":React.createElement(F.PanelBody,{ref:this.signoffPanelRef,initialOpen:!0,title:f},React.createElement("form",{className:"reusable-block-edit-panel"},0!==s.length?React.createElement("div",{id:"owf-error-message",className:"notice notice-error is-dismissible"},s.map((function(t){return React.createElement("p",{key:t},t)}))):"",React.createElement(F.SelectControl,{label:(0,r.__)("Action","oasisworkflow")+":",value:this.state.selectedAction,options:this.state.actions,onChange:this.getSignoffSteps.bind(this)}),c?React.createElement(ye,{stepDecision:u,handleResponse:this.props.handleResponse}):React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==y?React.createElement(F.Spinner,null):""),React.createElement(F.SelectControl,{label:(0,r.__)("Step","oasisworkflow")+":",value:this.state.selectedStep,options:this.state.signoffSteps,onChange:this.getSelectedStepDetails.bind(this)}),React.createElement(pt,{value:this.state.selectedPriority,onChange:this.handleOnPriorityChange.bind(this)}),React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==w&&0==this.state.assignToAll?React.createElement(F.Spinner,null):""),this.state.assignToAll?"":React.createElement(F.SelectControl,{multiple:!0,className:"ow-multi-select",label:p+":",value:this.state.selectedAssignees,options:this.state.assignee,onChange:function(e){return t.setState({selectedAssignees:e})}})),""!==d?React.createElement(F.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,h+":"," "),React.createElement(F.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog owduedatepicker-dropdown",renderToggle:function(t){var e=t.onToggle,n=t.isOpen;return React.createElement(o.Fragment,null,React.createElement(F.Button,{type:"button",onClick:e,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(rt,null)))},renderContent:function(){return React.createElement(nt,null)}})):"",React.createElement(F.PanelRow,null,React.createElement(F.TextareaControl,{label:(0,r.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(e){return t.setState({comments:e})}})),React.createElement(F.PanelRow,null,React.createElement(F.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:g,onClick:this.handleSignoff.bind(this)},f),React.createElement("div",{className:"owf-spinner"},"show"==v?React.createElement(F.Spinner,null):"")))))}}],i&&Ee(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,s,p,d,y}(o.Component);const De=(0,W.compose)([(0,h.withSelect)((function(t){var e=t("core/editor"),n=e.getCurrentPostId,r=e.getEditedPostAttribute,o=t("plugin/oasis-workflow"),i=o.getDueDate,a=o.getOWSettings,s=o.getPostInWorkflow;return{postId:n(),postMeta:r("meta"),dueDate:i(),owSettings:a(),isPostInWorkflow:s()}})),(0,h.withDispatch)((function(t){return{onSave:t("core/editor").savePost,setDueDate:t("plugin/oasis-workflow").setDueDate}}))])(Le),Ce=function(t){return React.createElement("div",null,(0,r.__)("If this is a custom post type, check this page: ","oasisworkflow"),React.createElement("a",{target:"_blank",href:"https://www.oasisworkflow.com/documentation/working-with-workflows/custom-post-type-support"},"custom post type support"),(0,r.__)(" for more information on how to make custom post type work with Gutenberg Editor.","oasisworkflow"))},Ae=function(t){return React.createElement("div",null,(0,r.__)("Workflow support for published posts is available with Pro version. ","oasisworkflow"),React.createElement("a",{target:"_blank",href:"https://www.oasisworkflow.com/documentation/working-with-workflows/revise-published-content"},(0,r.__)("Click here","oasisworkflow")),(0,r.__)(" for more information.","oasisworkflow"))};function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}function je(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ne(r.key),r)}}function Ne(t){var e=function(t){if("object"!=Ie(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ie(e)?e:e+""}function Be(t,e,n){return e=We(e),function(t,e){if(e&&("object"==Ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Me()?Reflect.construct(e,n||[],We(t).constructor):e.apply(t,n))}function Me(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Me=function(){return!!t})()}function We(t){return We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},We(t)}function Fe(t,e){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fe(t,e)}var Ue=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Be(this,e,arguments)).pluginSettings=null,t.submitButtonText="",t.state={submitToWorkflowResponse:"",signOffResponse:"",hideSignoff:!1,actionHistoryId:c(),hideClaimButton:!0,hidePlugin:!0,hidePluginMessage:(0,r.__)("Loading...","oasisworkflow")},t.showWorkflowSideBar=t.showWorkflowSideBar.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fe(t,e)}(e,t),n=e,(i=[{key:"componentDidMount",value:function(){var t=this;if(this.props.postId,this.props.isCurrentPostPublished){var e=React.createElement(Ae,null);this.setState({hidePlugin:!0,hidePluginMessage:e})}else if(null!=this.props.postMeta)this.props.setIsPostInWorkflow({isPostInWorkflow:this.props.postMeta._oasis_is_in_workflow}),this.setState({submitToWorkflowResponse:"",signOffResponse:""}),this.state.actionHistoryId&&m()({path:"/oasis-workflow/v1/workflows/claim/actionHistoryId="+this.state.actionHistoryId,method:"GET"}).then((function(e){t.setState({hideClaimButton:e.is_hidden})}),(function(t){return console.log(t),t})),m()({path:"/oasis-workflow/v1/workflows/submit/checkRoleCapability/postId="+this.props.postId+"/postType="+this.props.postType,method:"GET"}).then((function(e){if(e.is_role_applicable&&e.can_submit_to_workflow){var n=t,o=setInterval((function(){s(n.props.owSettings)||s(n.props.userCap)||(clearInterval(o),n.setState({hidePlugin:!1,hidePluginMessage:""}))}),500);if(e.can_skip_workflow&&!t.props.postMeta._oasis_original||([].forEach.bind(document.getElementsByClassName("editor-post-publish-panel__toggle"),(function(t){t.style.display="none"}))(),[].forEach.bind(document.getElementsByClassName("editor-post-publish-button"),(function(t){t.style.display="none"}))()),t.state.actionHistoryId&&t.props.onOpenSideBar("oasis-workflow-plugin/ow-workflow-sidebar"),!t.state.actionHistoryId&&!t.props.postMeta._oasis_is_in_workflow&&e.can_submit_to_workflow){t.submitButtonText=(0,r.__)("Submit to Workflow","oasisworkflow")+"...";var i=document.createElement("div");i.className="owf-submit-button-div",i.innerHTML='<button type="button" aria-label="'+t.submitButtonText+'" class="owf-submit-button components-button is-primary is-button is-large">'+t.submitButtonText+"</button>";var a=document.getElementsByClassName("edit-post-header__settings")[0]||document.getElementsByClassName("editor-header__settings")[0];if(a)for(var c=a.getElementsByTagName("*"),u=0;u<c.length;u++)if("function"==typeof c[u].className.indexOf&&-1!==c[u].className.indexOf("editor-post-publish-panel")){c[u].parentNode.insertBefore(i,c[u].nextSibling),document.getElementsByClassName("owf-submit-button")[0].onclick=t.showWorkflowSideBar;break}}}else{var l=(0,r.__)("Workflow actions are not available for this post type.","oasisworkflow");e.can_submit_to_workflow||(l=(0,r.__)("You are not allowed to submit to workflow.","oasisworkflow")),t.setState({hidePlugin:!0,hidePluginMessage:l})}}),(function(t){return console.log(t),t}));else{var n=React.createElement(Ce,null);this.setState({hidePlugin:!0,hidePluginMessage:n})}}},{key:"showWorkflowSideBar",value:function(){this.props.onOpenSideBar("oasis-workflow-plugin/ow-workflow-sidebar")}},{key:"handleWorkflowAbortResponse",value:function(){this.setState({submitToWorkflowResponse:"",signOffResponse:""}),this.props.setIsPostInWorkflow({isPostInWorkflow:!1})}},{key:"handleSubmitToWorkflowResponse",value:function(t){this.setState({submitToWorkflowResponse:t.success_response}),document.getElementsByClassName("owf-submit-button")[0].classList.add("owf-guten-hidden"),this.props.setIsPostInWorkflow({isPostInWorkflow:t.post_is_in_workflow})}},{key:"handleSignoffResponse",value:function(t){this.setState({signOffResponse:t.success_response,hideSignoff:!0}),this.props.setIsPostInWorkflow({isPostInWorkflow:t.post_is_in_workflow})}},{key:"render",value:function(){var t=this,e=this.state,n=e.submitToWorkflowResponse,i=e.signOffResponse,a=e.actionHistoryId,s=e.hideClaimButton,c=(e.hideCompareButton,e.hidePlugin),u=e.hidePluginMessage,l=e.hideSignoff;return React.createElement(o.Fragment,null,React.createElement(M.PluginSidebarMoreMenuItem,{target:"ow-workflow-sidebar"},(0,r.__)("Oasis Workflow","oasisworkflow")),React.createElement(M.PluginSidebar,{name:"ow-workflow-sidebar",title:(0,r.__)("Oasis Workflow","oasisworkflow")},c?React.createElement(F.PanelBody,null,React.createElement("div",{id:"owf-warning-message",className:"notice notice-error"},u)):React.createElement("div",null,React.createElement(Qt,{response:i}),React.createElement("div",null,!l&&null!==a&&s?React.createElement(De,{handleResponse:this.handleSignoffResponse.bind(this)}):""),React.createElement(Qt,{response:n}),React.createElement(Bt,{handleResponse:this.handleSubmitToWorkflowResponse.bind(this)}),React.createElement(ee,{isHidden:s,actionHistoryId:a,onClaim:function(){return t.setState((function(t){return{hideClaimButton:!t.hideClaimButton}}))}}),React.createElement(tt,{handleResponse:this.handleWorkflowAbortResponse.bind(this)}))))}}])&&je(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i}(o.Component),Ge=(0,W.compose)([(0,h.withSelect)((function(t){var e=t("core/editor"),n=e.getCurrentPostId,r=e.getCurrentPostType,o=e.isCurrentPostPublished,i=e.isCurrentPostScheduled,a=e.getEditedPostAttribute,s=t("core/edit-post").getActiveGeneralSidebarName,c=t("plugin/oasis-workflow"),u=c.getOWSettings,l=c.getUserCapabilities;return{postId:n(),postType:r(),postMeta:a("meta"),isCurrentPostPublished:o(),isCurrentPostScheduled:i(),activeGeneralSidebarName:s(),owSettings:u(),userCap:l()}})),(0,h.withDispatch)((function(t){return{onSave:t("core/editor").savePost,onOpenSideBar:t("core/edit-post").openGeneralSidebar,setIsPostInWorkflow:t("plugin/oasis-workflow").setIsPostInWorkflow}}))])(Ue);(0,U.registerPlugin)("oasis-workflow-plugin",{icon:p,render:Ge})})()})();